<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:ui="jakarta.faces.facelets">
<h:panelGroup rendered="#{bankBean.userRole eq 'Employee'}">
    <!-- Header with the user's role -->
        <h:panelGroup styleClass="header">
            <h3>Role:
                <h:outputText value="#{bankBean.userRole}" />
            </h3>
        </h:panelGroup>
        <!-- Kundensuche Section -->
        <h3>Kundensuche</h3>
        <h:form id="searchForm" styleClass="search-form">
            <h:panelGrid columns="4" >
                <h:outputLabel for="searchId" value="Kundennummer:" />
                <h:inputText id="searchId" value="#{employeeBean.customerId}" />

                <h:outputLabel for="searchName" value="Name:" />
                <h:inputText id="searchName" value="#{employeeBean.customerName}" />
            </h:panelGrid>
            <br />

            <h:commandButton value="Suchen" action="#{employeeBean.searchCustomer}">
                <f:ajax execute="@form" render="searchResults1 messagesSearch" />
            </h:commandButton>

            <h:messages id="messagesSearch" showDetail="true" style="color:red;" />

        <!-- Search Results Table -->
        <h:panelGroup styleClass="search-results-container">
            <h:dataTable id="searchResults1" value="#{employeeBean.searchCustomer}" var="result">
                <h:column styleClass="kid-col">
                    <f:facet name="header">Kundennummer</f:facet>
                    #{result.id}
                </h:column>
                <h:column styleClass="name-col">
                    <f:facet name="header">Name</f:facet>
                    #{result.firstName} #{result.lastName}
                </h:column>
                <h:column styleClass="address-col">
                    <f:facet name="header">Adresse</f:facet>
                    #{result.address}
                </h:column>
                <h:column>
                    <h:commandButton value="AuswÃ¤hlen">
                        <f:setPropertyActionListener target="#{employeeBean.selectedCustomer}" value="#{result}" />
                        <f:ajax execute="@this" render="searchForm:selectedCustomerPanel" />
                    </h:commandButton>
                </h:column>
            </h:dataTable>
        </h:panelGroup>

    <h:panelGroup id="selectedCustomerPanel" styleClass="#{not empty employeeBean.selectedCustomer ? '' : 'hidden'}">
        <h3>Kunde:</h3>
        <h:outputText value="Name: #{employeeBean.selectedCustomer.firstName} #{employeeBean.selectedCustomer.lastName}" />
        <br />
        <h:outputText value="Adresse: #{employeeBean.selectedCustomer.address}" />
        <br /><br />

        <h3>Aktien suchen</h3>
        <h:form id="stockSearchForm">
            <h:outputLabel for="searchQuery" value="Aktie suchen: " />
            <h:inputText id="searchQuery" value="#{customerBean.searchQuery}" />
            <h:commandButton value="Suchen" action="#{customerBean.searchStocks}">
                <f:ajax execute="@form" render="aktienSearch" />
            </h:commandButton>
        </h:form>

        <h:dataTable id="aktienSearch" value="#{customerBean.searchResults}" var="stock">
            <h:column>
                <f:facet name="header">Firma</f:facet>
                #{stock.companyName}
            </h:column>
            <h:column>
                <f:facet name="header">Letzter Kurs</f:facet>
                #{stock.lastTradePrice}
            </h:column>
            <h:column>
                <f:facet name="header">Marktkapitalisierung</f:facet>
                #{stock.marketCapitalization}
            </h:column>
        </h:dataTable>
    </h:panelGroup>
        </h:form>

    <!-- Neuer Kunde Form  -->
    <h3>Neuer Kunde</h3>
    <h:form id="customerForm" styleClass="new-customer-form">
        <!-- panelGrid with 2 columns  -->
        <h:panelGrid columns="6" >

            <!-- Row 1 -->
            <h:outputLabel for="customerId" value="Kundennummer:" />
            <h:inputText id="customerId" value="#{employeeBean.id}" />

            <h:outputLabel for="firstName" value="Vorname:" />
            <h:inputText id="firstName" value="#{employeeBean.firstName}" />

            <h:outputLabel for="lastName" value="Nachname:" />
            <h:inputText id="lastName" value="#{employeeBean.lastName}" />

            <!-- Row 2 -->
            <h:outputLabel for="address" value="Adresse:" />
            <h:inputText id="address" value="#{employeeBean.address}" />

            <h:outputLabel for="username" value="Username:" />
            <h:inputText id="username" value="#{employeeBean.username}" />

            <h:outputLabel for="password" value="Passwort:" />
            <h:inputText id="password" value="#{employeeBean.password}" />
        </h:panelGrid>

        <br />
        <h:commandButton value="Kunde anlegen" action="#{employeeBean.addCustomer}">
            <f:ajax execute="@form" render="@form messagesAdd" />
        </h:commandButton>
        <h:messages id="messagesAdd" showDetail="true" styleClass="jsf-messages" />
    </h:form>
</h:panelGroup>

    <style>
        .hidden {
            display: none;
        }
    </style>
</ui:composition>